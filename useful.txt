#!/usr/bin/env bash

# To install nltk stopwords
python -m nltk.downloader stopwords

# To start app on localhost
python run.py 127.0.0.1 6688

# To start app on web
python run.py 0.0.0.0 6688

# Sample api call on localhost
curl -i http://localhost:6688/categorize -X post -H "Content-type: application/json" -d'{"title":"blue iphone 6s handphone case with free strap"}'
curl -i http://localhost:6688/categorize -X post -H "Content-type: application/json" -d'{"title":"logitech m570 mouse with thumb scroll"}'
curl -i http://localhost:6688/categorize -X post -H "Content-type: application/json" -d'{"title":"blue casual ladies little black dress"}'

# Sample api call to machine ipaddress
curl -i http://192.168.1.107:6688/categorize -X post -H "Content-type: application/json" -d'{"title":"blue iphone 6s handphone case with free strap"}'
curl -i http://192.168.1.107:6688/categorize -X post -H "Content-type: application/json" -d'{"title":"logitech m570 mouse with thumb scroll"}'
curl -i http://192.168.1.107:6688/categorize -X post -H "Content-type: application/json" -d'{"title":"blue casual ladies little black dress"}'

# connect to ec2
ssh -i ~/.ssh/eugene_aws.pem ubuntu@ec2-54-169-212-169.ap-southeast-1.compute.amazonaws.com

# Generate ssh
ssh-keygen -t rsa -C "eugeneyanziyou@gmail.com"
cat .ssh/id_rsa.pub

# Clone library
git clone git@gitlab.com:eugeneyan/datagene.git
mkdir -p datagene/data/model

# upload files to ec2
scp -i ~/.ssh/eugene_aws.pem categorization_dicts_small.tar.gz ubuntu@ec2-54-169-212-169.ap-southeast-1.compute.amazonaws.com:datagene/data/model

# create virtualenv
cd datagene
mkvirtualenv -a $(pwd) test -p /home/ubuntu/anaconda2/bin/python

# Product API site
http://ec2-52-77-217-245.ap-southeast-1.compute.amazonaws.com:6688
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Product categorization using image</title>
    <link href="http://getbootstrap.com/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://getbootstrap.com/examples/jumbotron-narrow/jumbotron-narrow.css" rel="stylesheet">
    <link href="../static/css/fileinput.css" media="all" rel="stylesheet" type="text/css"/>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="../static/js/fileinput.js" type="text/javascript"></script>
    <script src="../static/js/fileinput_locale_fr.js" type="text/javascript"></script>
    <script src="../static/js/fileinput_locale_es.js" type="text/javascript"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js" type="text/javascript"></script>

</head>

<body>
<div class="container">

    <nav>
        <ul class="nav nav-pills pull-right">
            <li role="presentation"><a href="{{ url_for('index') }}">Back to Home</a></li>
        </ul>
    </nav>

    <div class="header">
        <h3 class="text-muted">Product Categorization using image</h3>
    </div>

    <p>Suggests five Amazon fashion categories to place a product in based on image. Works best with e-commerce
        fashion images on white background (because that's what it's trained on). </p>
    <p> Top-1 validation accuracy: 0.760, Top-5 validation accuracy: 0.974 </p>

    <form enctype="multipart/form-data" action="{{ url_for('image_categorize_web') }}" method="POST">
        <!--<div class="form-group">-->
            <!--<input id="file-1" name="image" type="file">-->
        <!--</div>-->
        <div class="input-group">
            <label class="input-group-btn">
                <span class="btn btn-primary">
                    Browse &hellip; <input type="file" name="image" style="display: none;" multiple>
                </span>
            </label>
            <input type="text" class="form-control" readonly>
        </div>
        <span class="help-block">
            Browse and select a file
        </span>

        <br>

        <div class="form-group">
            <label class="btn btn-primary"> Submit <input type="submit" style="display: none;" value="submit"> </label>
            <!--<span class="help-block">-->
                <!--Please wait 3 min after clicking submit. Running 100+ layer deep learning model on tiny aws server-->
                <!--without GPU. I'll be much faster in batch mode with a GPU =)-->
            <!--</span>-->
        </div>
    </form>

    <br>
    <ul class="list-group-item active">
        Category Suggestions
    </ul>
    {% for key, value in result.iteritems() %}
    <li style="text-align: left" class="list-group-item"> {{ '{} ({:.2f})'.format(value[0], value[1]) }}</li>
    {% endfor %}

    <br>
    <ul class="list-group">
        <li style="text-align: left" class="list-group-item"> {{ 'Time taken: {:.2f} seconds'.format(elapsed_time) }}</li>
    </ul>

    <footer class="footer">
        <p>&copy; eugeneyan 2016</p>
    </footer>
</div>
</body>

<script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-85787628-1', 'auto');
      ga('require', 'displayfeatures');
      ga('send', 'pageview');


    $(function() {

      // We can attach the `fileselect` event to all file inputs on the page
      $(document).on('change', ':file', function() {
        var input = $(this),
            numFiles = input.get(0).files ? input.get(0).files.length : 1,
            label = input.val().replace(/\\/g, '/').replace(/.*\//, '');
        input.trigger('fileselect', [numFiles, label]);
      });

      // We can watch for our custom `fileselect` event like this
      $(document).ready( function() {
          $(':file').on('fileselect', function(event, numFiles, label) {

              var input = $(this).parents('.input-group').find(':text'),
                  log = numFiles > 1 ? numFiles + ' files selected' : label;

              if( input.length ) {
                  input.val(log);
              } else {
                  if( log ) alert(log);
              }

          });
      });

    });
</script>
</html>
